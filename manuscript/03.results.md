## Results

### Systems serology measurements can be drastically reduced without loss of information

We first sought to determine whether recognizing the structure of systems serology measurements could inform better data reduction strategies (FIG). To integrate antigen-specific and -generic measurements, we developed an adjusted form of tensor factorization we will refer to as total coupled matrix-tensor factorization (TMTF) (FIG). By concatenating both the tensor and matrix during the alternating least squares (ALS) solve for the patient dimension, we maximize the variance explained across both datasets (FIG). In contrast to coupled matrix-tensor factorization, we solve for factors that both jointly explain both data structures, as well as ones which explain the variation unique to the matrix [@PMID:31251750] (FIG). In doing so, our factors explain the totality of the variation in both data sets. Each ALS step is performed with a censored least squares solver to ignore missing values.

To determine the extent of data reduction possible, we examined the reconstruction error upon decomposition with varying numbers of components (Fig. {@fig:compress}A). As we start with a tensor of 181✖️22✖️41 and matrix of 181✖️25, we start with 167,787 total measurements. 43% of these are missing, meaning that in fact the original dataset contains 96,027 total measurements. After factorization with 6 components, we are left with four matrices of 181x6, 22x6, 41x6, and 25x6. Therefore, we reduce the dataset by 59-fold to 1,614 numbers, while preserving ~90% of its variation (Fig. {@fig:compress}A). We compared this to the dimensionality reduction possible with principal components analysis (PCA) and the data organized in a flattened matrix form (Fig. {@fig:compress}B). TMTF consistently led to a similar accuracy on reconstruction with half the resulting factorization size compared to PCA (Fig. {@fig:compress}B). This gave us confidence that this structured factorization can greatly reduce the data while preserving its meaningful variation.

![**TMTF improves data reduction of systems serology measurements.** A) Percent variance reconstructed (R2X) versus the number of components used in TMTF decomposition. B) TMTF fitting error compared to PCA versus the size of the resulting factorization.](figure0.svg "Figure 1"){#fig:compress width="100%"}

### Factorization accurately imputes missing values

With confidence that factorization was reconstructing consistent patterns within the HIV serology response, we wondered if our approach might improve handling of missing values. Systems serology measurements require a panoply of different measurements in combination; especially in such large-scale efforts, measurements can be missing for a variety of reasons. Patient samples can be limited, and so only be available for a small set of measurements. A subset of measurements may be of particular interest to investigators; for example, surface antigens to a virus may be prioritized for more detailed Fcγ receptor binding measurements, since they are more likely to be exposed in the extracellular space. Effective imputation allows for outlier detection, or identifying assays that may have technical problems. Finally, observing that factorization accurately imputes missing values further supports that this approach identifies biologically-meaningful patterns and is amenable to studies of reduced scale.

To evaluate whether factorization could accurately impute missing values, we artificially introduced missing values by randomly removing receptor-antigen pairs throughout the entire dataset. TMTF was then performed which effectively filled these in, and we then calculated the variance inferred in this left-out data (Fig. {@fig:impute}A). Factorization imputed these values with similar accuracy to the variance explained within observed measurements, supporting that it is able to identify meaningful patterns even in the presence of missing measurements. This provides additional evidence that the patterns identified through factorization are a meaningful and substantial representation of the data.

![**Systems serology measurements contain a small number of consistent patterns across their measurements.** A) Percent variance predicted (Q2X) versus the number of components used for imputation of held out receptor-ligand pairs.](figure1.svg "Figure 1"){#fig:impute width="100%"}

### Factor components represent consistent patterns in the HIV humoral immune response

Systems serology measurements have typically been assessed through regularized methods, such as elastic net and partial least squares regression, on the measurements themselves [@DOI:10.15252/msb.20177881; @DOI:10.1016/j.cell.2015.10.027]. These methods are very effective at prediction, and do provide some interpretation of the mechanism behind those predictions. However, a measurement-centric perspective can hide that immune responses occur through polyclonal responses across antigens and through regulatory changes that affect multiple receptors. Systems serology measurements further complicate interpretation due to the nature of the measurements, which are affected by both antigen binding and immune receptor interaction differences [@PMID:29268769].

In contrast, tensor factorization provides a much more interpretable view of the coordinate changes along these dimensions (Fig. @fig:factors). To visualize the resulting factors, we plotted all of the components along their patient (Fig. {@fig:factors}A), receptor (Fig. {@fig:factors}B), antigen (Fig. {@fig:factors}C), and glycan (Fig. {@fig:factors}D) factors. To interpret the resulting plots, one can examine the values of an individual component along each plot, as each component represents a separate pattern of variation within the data (additively separable variation).

![**Factor components represent consistent patterns in the HIV humoral immune response.** Decomposed components along subjects (A), receptors (B), antigens (C), and glycans (D). All plots are shown on a common color scale.](figure2.svg "Figure 2"){#fig:factors width="100%"}

### Structured data decomposition accurately predicts functional measurements and patient classes

With confidence that our approach to data decomposition led to accurate data reduction, we evaluated whether our reduced factors could predict the functional responses of immune cells and patient classes. As a baseline of comparison, we reimplemented the immune functionality and patient predictions previously applied to this data [@DOI:10.15252/msb.20177881]. We observed similar performance to that reported (Fig. @fig:prediction). Differences could be explained by corrections we made to the cross-validation strategy to prevent over-fitting.

Next we benchmarked the ability of the factorized results to make these same predictions. TMTF represents the variation among patients within a patient matrix (Fig. {@fig:factors}A). To make predictions, one needs only work with these patient factors rather than the hundreds of original variables in the entire dataset. Furthermore, TMTF provides factorization results for each subject despite the presence of missing values. We therefore were able to use all 181 subjects for the purposes of predicting each subject's features.

As we observed systematic, non-linear trends between the genotype-specific and -generic measurements across antigens (Fig. [@fig:binding]), we expected that there might be a non-linear relationship between our factors and each prediction. Having greatly reduced the number of variables, we applied a gaussian process model to predict each function and patient class allowing for non-linear effects [@ISBN:0-262-18253-X]. We separated our quantification of model accuracy based on whether a subject was included or excluded within previous studies [@DOI:10.15252/msb.20177881].

Broadly, we saw a consistent improvement in our ability to predict immune functional responses (Fig. {@fig:factors}A). This was also the case for predicting whether subjects were classified as progressors or viremic (Fig. {@fig:factors}B). The previously excluded cases, for which missing values were more abundant, were predicted with similar or better accuracy to those previously included (Fig. {@fig:factors}A/B). We therefore concluded that data reduction can help to improve predictions of immune function response and of patient's clinical features.

![**Structured data decomposition more accurately predicts functional measurements and patient classes.** (A) Accuracy of prediction for different functional response measurements. (B) Prediction accuracy for patient viral and controller status. (C) Accuracy of of prediction for different functional response measurements in patients who were excluded previously due to missing measurements.](figure3.svg "Figure 3"){#fig:prediction width="100%"}

### Immune function correlates match biological mechanisms 

ADCD was most prominently predicted using components 2 and 3, then secondarily 5 and 8. The mechanistic importance of components 2 and 3 is clearly identified by recognizing that both most prominently explain variation in LCA, PNA, and SNA lectin binding (DEFINE), indicative of lectin-pathway complement activation (CITE). (MORE). Component 5 carried the strongest weight for C1q binding and so likely indicates classical pathway activation. 



ADCC was clearly predicted using components 3, 4, and 6. 


Antibody-dependent neutrophil-mediated phagocytosis (ADNP) was most prominently explained by components 2 and 3, then secondarily component 6. These higlight two mechanisms of driving neutrophil phagocytosis—via lectin engagement and/or FcgR binding. All three of these components prominently weight lectin binding.






## HIV progression and viremia occur through multi-antigen responses

Progression was most prominently explained by component 5, and secondarily components 2 and 10. Interestingly, component 5 corresponds to increased amounts of p24 binding to both HXBc2 and IIIb strains. Abundance of p24 antigen has been proposed as an effective marker of HIV progression [@PMID:11118855], and predictive of death [@PMID:11109648], although much of this prediction is dependent upon correlation with viral RNA and CD4+ counts [@DOI:10.1086/322045]. This component also displays negative weighting across gp120 and gp140 antigens, likely reflecting a decrease in antibody titers overall [@PMID:8118788]. Therefore, while features of p24 abundance or antibody titers may have a complex relationship with progression, an increase in p24 titers alongside a decrease in titers overall may be more predictive of progression. (OTHER COMPONENTS?)

Viremia was related to a broader set of components 6, 7, and 9. 
