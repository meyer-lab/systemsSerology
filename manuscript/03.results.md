## Results

### Systems serology measurements can be drastically reduced without loss of information

We first sought to determine whether recognizing the structure of systems serology measurements could inform better data reduction strategies (Fig. @fig:cartoon). To integrate antigen-specific and -generic measurements, we developed a new form of tensor decomposition we will refer to as total coupled matrix-tensor factorization (TMTF) (Fig. {@fig:cartoon}C). By concatenating both the unfolded tensor and matrix during the alternating least squares (ALS) solve for the subject dimension, we maximize the variance explained across both datasets (Fig. {@fig:cartoon}D, see methods). This is in contrast to coupled matrix-tensor factorization, which only explains the variance shared between the datasets [@PMID:31251750] (Fig. {@fig:cartoon}D).

![**Systems serology measurements have a consistent multi-dimensional structure.** A) General description of the data. Antibodies are first separated based on their binding to a panel of disease-relevant antigens. Next, the binding of those immobilized antibodies to a panel of immune receptors is quantified. Other molecular properties of the disease-specific antibody fraction that affect immune engagement, such as glycosylation, may be quantified in parallel in an antigen-specific or -generic manner. These measurements have been shown to predict both disease status and immune functional properties. B) Overall structure of the data. Antigen-specific measurements can be arranged in a three-dimensional tensor wherein one dimension each indicates subject, antigen, and receptor. In parallel, antigen-generic measurements such as quantification of glycan composition can be arranged in a matrix with each subject along one dimension, and each glycan feature along the other. While the tensor and matrix differ in their dimensionality, they share a common subject dimension. C) The data is reduced by identifying additively-separable components represented by the outer product of vectors along each dimension. The subjects dimension is shared across both the tensor and matrix reconstruction. D) Venn diagram of the variance explained by each factorization method. Canonical polyadic (CP) decomposition can explain the variation present within either the antigen-specific tensor or glycan matrix on their own [@PMID:18003902]. CMTF allows one to explain the shared variation between the matrix and tensor [@PMID:31251750]. In contrast, here we wish to explain the total variation across both the tensor and matrix. This is accomplished with TMTF (see methods).](images/schematic.svg "Figure Cartoon"){#fig:cartoon width="100%"}

To determine the extent of data reduction possible, we examined the reconstruction error upon decomposition with varying numbers of components (Fig. {@fig:compress}A). As we start with a 181x22x41 tensor and 181x25 matrix, we start with a dataset of 168,000 values, of which 96,000 or 57% were measured and therefore not missing. After factorization with 10 components, we are left with four matrices of 181x10, 22x10, 41x10, and 25x10. Therefore, we reduce the dataset to 2.8% of the size (2,690 numbers), while preserving 93% of its variation (Fig. {@fig:compress}A). We compared this to the dimensionality reduction possible with PCA and the data organized in a flattened matrix form (Fig. {@fig:compress}B). TMTF consistently led to a similar accuracy on reconstruction with half the resulting factorization size compared to PCA (Fig. {@fig:compress}B). For example, TMTF led to a normalized unexplained variance of 0.15 at ~1,024 values within the factorization, while PCA required ~2,048 to do the same. This gave us confidence that this structured factorization can greatly reduce the data while preserving its meaningful variation.

![**TMTF improves data reduction of systems serology measurements.** A) Percent variance reconstructed (R2X) versus the number of components used in TMTF decomposition. B) TMTF reconstruction error compared to PCA over varying sizes of the resulting factorization. The unexplained variance is normalized to the starting variance. Note the log scale on the x-axis.](figure0.svg "Figure 1"){#fig:compress width="100%"}

### Factorization accurately imputes missing values

With confidence that factorization was identifying consistent patterns within the HIV serology response, we wondered if our approach might improve missing values imputation. Systems serology measurements require a panoply of different measurements in combination; especially in such large-scale efforts, measurements can be missing for a variety of reasons. Subject samples can be limited, and so only be available for a small set of measurements. A subset of measurements may be of particular interest to investigators; for example, surface antigens to a virus may be prioritized for more detailed Fcγ receptor binding measurements, since they are more likely to be exposed in the extracellular space. Effective imputation also allows for outlier detection, for example to identify assays that may have technical problems. Finally, observing that factorization accurately imputes missing values further supports that this approach identifies biologically-meaningful and consistent patterns.

To evaluate whether factorization could accurately impute missing values, we artificially introduced missing values by randomly removing receptor-antigen pairs throughout the entire dataset. TMTF was then performed which effectively filled these in, and we then calculated the variance inferred in this left-out data (Fig. {@fig:impute}A). Factorization imputed these values with similar accuracy to the variance explained within observed measurements (Fig. {@fig:compress}A), supporting that it is able to identify meaningful patterns even in the presence of missing measurements. This provides additional evidence that the patterns identified through factorization are a meaningful and substantial representation of the data.

![**TMTF accurately imputes missing values.** Percent variance predicted (Q2X) versus the number of components used for imputation of held out receptor-ligand pairs.](figure1.svg "Figure 1"){#fig:impute width="50%"}

### Factor components represent consistent patterns in the HIV humoral immune response

Systems serology measurements have typically been used through regularized prediction methods, such as elastic net and partial least squares regression, on the measurements themselves [@DOI:10.15252/msb.20177881; @DOI:10.1016/j.cell.2015.10.027]. These methods are very effective at prediction, and do provide some interpretation of the mechanism behind those predictions. However, a measurement-centric perspective can hide that immune responses occur through polyclonal responses across antigens and through regulatory changes that affect multiple receptors. Systems serology measurements further complicate interpretation due to the combined influence of both antigen binding and immune receptor interaction differences [@PMID:29268769].

In contrast, tensor factorization provides a much more interpretable view of the coordinate changes along these dimensions (Fig. @fig:factors). To visualize the resulting factors, we plotted all of the components along their subject (Fig. {@fig:factors}A), receptor (Fig. {@fig:factors}B), antigen (Fig. {@fig:factors}C), and glycan (Fig. {@fig:factors}D) factors. Notably, these factors quantitatively visualize these measurements in their totality, which has not been possible to date. To interpret the resulting plots, one can examine the values of an individual component along each plot, as each component represents a separate pattern of variation within the data (additively separable variation).

Through inspection of each individual component, one can understand the consistent patterns across the serology measurements. For example, component 4 explains a pattern of variation specifically in IgG1 (Fig. {@fig:factors}B) and Gag (Fig. {@fig:factors}C). The amount of this Gag-binding IgG1 varies according to each subjects component 4 value (Fig. {@fig:factors}A). Finally, variation along this component corresponds to variation in glycan composition, most prominently a decrease in G1F and G1 overall (Fig. {@fig:factors}D). As each component is additively independent, they can be inspected on a component-by-component basis to explore every pattern of variation within the serology.

The factorization revealed many interesting quantitative patterns. For example, component 5 represents a shift between surface antigen (gp120, gp140) and p24/p51/p66 binding (Fig. {@fig:factors}C), which would be nearly impossible to identify without separation of receptor and antigen effects. We identified that some technical artifact resulted in genotype-specific FcγRIIIa measurements that are more sensitive than the genotype-generic ones (Fig. {@fig:binding}). All three components that we interpreted as explaining low-affinity FcγRIIIa binding—1, 2, and 9—also had high overall fucosylation and G0F weights (Fig. {@fig:factors}D). These glycosylation changes are known to hinder FcγRIIIa interaction and therefore ADCC [@DOI:10.3389/fimmu.2017.00877]. C1q binding was most heavily weighted along component 5 (Fig. {@fig:factors}B), which also weighted coordinate galactosylation and fucosylation (Fig. {@fig:factors}D, G2F/G1FB/G1F), known to coordinate complement [@DOI:10.3389/fimmu.2017.00877]. These observations support that the factorized components represent meaningful variation, and that they can be used for mechanistic insight.

![**Factor components represent consistent patterns in the HIV humoral immune response.** Decomposed components along subjects (A), receptors (B), antigens (C), and glycans (D). All plots are shown on a common color scale. Measurements were not normalized, and so magnitudes within a component are meaningful. Antigen names indicate both the protein (e.g., gp120, gp140, gp41, Nef, Gag) and strain (e.g., Mai, BR29).](figure2.svg "Figure 2"){#fig:factors width="100%"}

### Structured data decomposition accurately predicts functional measurements and subject classes

Next, we evaluated whether our reduced factors could predict the functional responses of immune cells and subject classes. As a baseline of comparison, we reimplemented the immune functionality and subject predictions previously applied to this data [@DOI:10.15252/msb.20177881]. We observed similar performance to that reported (Fig. @fig:prediction). Differences could be explained by corrections we made to the cross-validation strategy to prevent over-fitting (see methods).

Next we benchmarked the ability of the factorized results to make these same predictions. TMTF represents the variation among subjects within a subject matrix (Fig. {@fig:factors}A). To make predictions, one needs only work with these subject factors rather than the hundreds of original variables in the entire dataset. Furthermore, TMTF provides factorization results for each subject despite the presence of missing values. We therefore were able to use all 181 subjects for the purposes of predicting each subject's features.

Particularly as we observed systematic, non-linear trends between the genotype-specific and -generic measurements across antigens (Fig. @fig:binding), we surmised that there might be a non-linear relationship between our factors and each prediction. Greatly reducing the number of variables to 10 components allowed us to apply a Gaussian process model to predict each function and subject class, allowing for non-linear effects [@ISBN:0-262-18253-X]. We separated our quantification of model accuracy based on whether a subject was included or excluded within previous studies [@DOI:10.15252/msb.20177881].

Broadly, we saw a consistent improvement in our ability to predict immune functional responses (Fig. {@fig:factors}A). This was also the case for predicting whether subjects were classified as progressors or viremic (Fig. {@fig:factors}B). Most impressively, the cases that were previously excluded due to missing values were predicted with similar accuracy (Fig. {@fig:factors}A/B). Therefore, data reduction can help to improve predictions of immune function response and of subject's clinical features.

![**Structured data decomposition more accurately predicts functional measurements and subject classes.** (A) Accuracy of prediction (defined as the Pearson correlation coefficient) for different functional response measurements. (B) Prediction accuracy for subject viral and controller status. For the TMTF results, the accuracy scores were separately calculated for those subjects who were previously included or excluded due to missing measurements.](figure3.svg "Figure 3"){#fig:prediction width="75%"}

### Immune function correlates match biological mechanisms

<!-- TODO: Add transition and revise this whole section. Mention conservatism of model variable selection. -->

ADCD was most prominently predicted using components 2, 5, and 8 (Fig. {@fig:import}A). The mechanistic importance of component 2 is clearly identified by its heavy weighting of LCA, PNA, and SNA binding, indicative of lectin-pathway complement activation (Fig. {@fig:factors}B) [@PMID:26082779]. Component 5 carried the strongest weight for C1q binding and so likely indicates classical pathway activation [@PMID:26082779]. As expected given galactosylation has been observed as the most predictive glycan form of C1q deposition [@DOI:10.3389/fimmu.2017.00877], component 5 also strongly weighted various galactosylation forms (Fig. {@fig:factors}D).

ADCC was clearly predicted through negative associations with components 3 (negatively), 4, and 6 (Fig. {@fig:import}A). Component 6 represents broad antigen binding across both gp120 and gp140, along with differences between the genotype-specific and -generic receptor measurements (Fig. {@fig:factors}B/C). Broadly, the receptor profile seems to negatively weight more sensitive receptor measurements, and positively weight those that were less sensitive (Fig. {@fig:binding}). Therefore, this component likely represents high avidity antigen binding which overcomes the lower sensitivity of the positively-weighted receptor measurements.

Antibody-dependent neutrophil-mediated phagocytosis (ADNP) was most prominently explained by components 2, 3, and 6 (Fig. {@fig:import}A). These higlight two mechanisms of driving neutrophil phagocytosis—via lectin engagement (components 2 and 3) and/or high-avidity FcγR binding (component 6).

All three cytokines most prominently depended upon component 6 (Fig. {@fig:import}A). As discussed above, this component likely represents high-avidity binding across surface antigens, and so its role in these responses is to be expected. Further, we might expect similar models across these cytokines as their amounts are highly correlated across subjects. Overall, our model interpretation supports that the decomposed factors identify relevant patterns in the serological responses.

![**Model component effects.** Model component effects for each function (A) and subject class (B) prediction. Component effects were calculated by quantifying the reduction in model accuracy upon cross-validation with each variable individually removed. Bars are only shown for significant (greater than 0.1 reduction) components. The direction of the component effect is indicated by the sign of the bar. This is calculated using the sign of the component weighting in an ordinary least squares model.](figure4.svg "Figure 4"){#fig:import width="100%"}

### HIV progression and viremia occur through multi-antigen responses

The clinical properties of a disease likely involve coordinated immune functions. As a result, being able to reason about a small number of consistent immunological patterns might be especially helpful for interpreting predictive models. Therefore, we took a similar approach for evaluating the variable dependence for predictions of subject progression and viremic status.

Remarkably, progression was exclusively explained by the single component 5 (Fig. {@fig:import}B). Component 5 corresponds to increased amounts of p24 binding across strains. Abundance of p24 antigen and its antibody titer has been proposed as an effective marker of HIV progression [@PMID:11118855], and predictive of death [@PMID:11109648], although much of this is via correlation with viral RNA and CD4+ counts [@DOI:10.1086/322045]. This component also displays negative weighting across gp120 and gp140 antigens, likely reflecting a decrease in antibody titers overall, which has separately been found to predict progression [@PMID:8118788]. Therefore, while features of p24 abundance or antibody titers may have an incomplete and complex relationship with progression, a p24/gp120 ratio may be more predictive.

Viremia was related to a broader set of components, most prominently 6 and then secondarily 1, 2, and 3 (Fig. {@fig:import}B). Given the importance of component 6 in predicting nearly all of the functional measurements (Fig. {@fig:import}A), its loss contributing to viremia is to be expected. Component 3 strongly weighted binding to Nef antigen (Fig. {@fig:import}B). Non-functional variants of Nef have been identified to contribute to early viremic control [@PMID:24965469]. Therefore, Nef binding may be a reflection of its presence and therefore function in subjects, contributing to viremic status. In all, a small number of consistent patterns accurately predict subjects' HIV infection status.
