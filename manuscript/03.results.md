## Results

### Systems serology measurements can be drastically reduced without loss of information

We first sought to determine whether recognizing the structure of systems serology measurements could inform better data reduction strategies. To integrate antigen-specific and -generic measurements, we developed an adjusted form of tensor factorization we will refer to as total coupled matrix-tensor factorization (T-CMTF). In contrast to coupled matrix-tensor factorization, we solve for factors that both jointly explain both data structures, as well as ones which explain the variation unique to the matrix [@PMID:31251750]. In doing so, our factors explain the totality of the variation in both data sets. Briefly, we solve for the CANDECOMP/PARAFAC (CP) decomposition of the tensor, project these factors onto the matrix, and then only decompose the residual variation within the matrix [@DOI:10.1137/07070111X]. Each step is additionally performed iteratively with masking to allow for missing values.

To determine the extent of data reduction possible, we examined the reconstruction error upon decomposition with varying numbers of components (Fig. XXX). As we start with a tensor of 181✖️22✖️41 and matrix of 181✖️25, we start with 167,787 total measurements. 43% of these are missing, meaning that in fact the original dataset contains 96,027 total measurements. After factorization with 6 coupled and 6 matrix-specific components, we are left with four matrices of 181x12, 22x6, 41x6, and 25x6. Therefore, we reduce the dataset by 36-fold to 2,700 numbers, while preserving 75% of its variation (Fig. XXX). This gave us confidence that this structured factorization greatly reduced the data while preserving its meaningful biological patterns.

![**Systems serology measurements contain a small number of consistent patterns across their measurements.**](figure1.svg "Figure 1"){#fig:R2X width="100%"}

### Structured data decomposition more accurately predicts functional measurements and patient classes

With confidence that our approach to data decomposition led to accurate data reduction, we evaluated whether our reduced factors could predict the functional responses of immune cells and patient classes. As a baseline of comparison, we reimplemented the immune fnuctionality and patient predictions previously applied to this data, and observed identical performance to that reported (Fig. @fig:prediction) [@DOI:10.15252/msb.20177881].



![**Structured data decomposition more accurately predicts functional measurements and patient classes.** (A) Accuracy of prediction for different functional response measurements. (B) Prediction accuracy for patient viral and controller status. (C) Accuracy of of prediction for different functional response measurements in patients who were excluded previously due to missing measurements.](figure2.svg "Figure 2"){#fig:prediction width="100%"}

### Factor components represent consistent patterns in the HIV humoral immune response

Systems serology measurements have typically been assessed through regularized methods, such as elastic net and partial least squares regression, on the measurements themselves (CITE). These methods are very effective at prediction, and do provide some interpretation of the mechanism behind those predictions. However, a measurement-centric perspective can hide that immune responses occur through polyclonal responses across antigens and regulatory changes that affect multiple receptors. Systems serology measurements further complicate interpretation due to the structure of the data, where measurements can be affected either by antigen binding or immune receptor interaction differences (CITE).

In contrast, tensor factorization provides a much more interpretable view of the coordinate changes along these dimensions (Fig. @fig:factors).


![**Factor components represent consistent patterns in the HIV humoral immune response.**](figure3.svg "Figure 3"){#fig:factors width="100%"}

### Factorization accurately imputes missing values

With confidence that factorization was reconstructing consistent patterns within the HIV serology response, we wondered if our approach might improve handling of missing values. Systems serology measurements require a panoply of different measurements in combination, and in such efforts measurements can be missing for a variety of reasons. Patient samples can be limited, and so only be available for a small set of measurements. A subset of measurements may be of particular interest to investigators; for example, surface antigens to a virus may be prioritized for FcgR measurements, since they are more likely to be exposed in the extracellular space. Finally, observing that factorization accurately imputes missing values would further support that this approach is robust to missing values and studies of reduced scale.

To evaluate whether factorization could accurately impute missing values, we artitificially introduced missing values by randomly removing them throughout the entire dataset. AMTF was then performed which effectively filled these in. We then calculated the reconstruction error from doing this compared with using the average of each measurement (FIGURE). Factorization provided substantially more accurate imputation, further supporting that it is able to identify meaningful patterns even in the presence of missing measurements. While most of the missing values are not individual missing values, but rather entire sets of antigen-receptor pairs ...

