## Methods

All analysis was implemented in Python v3.8 and can be found at <https://github.com/meyer-lab/systemsSerology>.

### Total Matrix-Tensor Factorization

We decomposed the series of systems serology measurements into a reduced series of Kruskal-formatted factors. Tensor operations were defined using Tensorly [@arXiv:1610.09555]. To capture the structure of the data, where the majority of measurements were made for specific antigens, but antibody glycosylation was measured in an antigen-agnostic form, we separated these two types of data into separate tensors, with shared patient-dimension factors:

$$X_{antigen} \approx \sum_{r=1}^R a_r \circ b_r \circ c_r$$

$$X_{glycosylation} \approx \sum_{r=1}^R a_r \circ d_r$$

Due to this unusual decomposition form, and a high percentage of missing values, we solved for the decomposition using standard optimization of a cost function:

$$C = \Vert X_{antigen} - \hat{X}_{antigen} \Vert + \Vert X_{glycosylation} - \hat{X}_{glycosylation} \Vert + \Vert p \Vert$$

Where missing values were masked such that they did not contribute to the cost. The regularization of each parameter value served to address the scaling indeterminacy of the Kruskal form. We performed the optimization using the conjugate gradient algorithm within SciPy [@DOI:10.1038/s41592-019-0686-2]. Fitting with different random starting points consistently converged to the same decomposition results. The parameter Jacobian was calculated using reverse-mode autodifferentiation using Jax. After fitting, we normalized both Kruskal tensors such that their factor components had unit variance and flipped the sign of factor pairs so that each component had positive mean within the receptor and antigen factors. 

### Supervised Regression and Classification




### Missingness Imputation




