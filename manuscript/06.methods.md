## Methods

All analysis was implemented in Python v3.8 and can be found at <https://github.com/meyer-lab/systemsSerology>.

### Total Matrix-Tensor Factorization

We decomposed the series of systems serology measurements into a reduced series of Kruskal-formatted factors. Tensor operations were defined using Tensorly [@arXiv:1610.09555]. To capture the structure of the data, where the majority of measurements were made for specific antigens, but antibody glycosylation was measured in an antigen-agnostic form, we separated these two types of data into separate tensors, with shared patient-dimension factors:

$$X_{antigen} \approx \sum_{r=1}^R a_r \circ b_r \circ c_r$$

$$X_{glycosylation} \approx \sum_{r=1}^R a_r \circ d_r$$

Decomposition was performed through an alternating least squares (ALS) scheme (CITE). FILL IN.


Missing values within the antigen-specific tensor were arranged in a specific pattern. That is, if a particular receptor-antigen pair measurement was made for any one patient, it was made for every patient in the cohort. This structure allowed us to remove the contribution of these missing values by removing these tensor chords from both the Katri-Rao product and unfolded tensor when solving for the patient mode matrix. This vastly improved convergence.

The ALS iterations were repeated until the improvement in R2X across both the matrix and tensor was less than $1\times 10^{-7}$ over the last ten iterations.

### Supervised Regression and Classification




Unlike in earlier work, we employed a nested, 20-fold cross-validation strategy, wherein the regularization amount was determined separately within each cross-validation fold. Hyperparameter selection outside of each cross-validation fold is known to consistently lead to model over-fitting (CITE). For the classification problems the cross-validation was stratified by class to preserve similar balance between the classes.

CITE: https://jmlr.org/papers/v11/cawley10a.html

### Missingness Imputation

To evaluate the ability of factorization to impute missing data, we introduced artificial missing values by removing chords from the antigen-specific tensor, and then looking at the variance explained on reconstruction (Q2X). More specifically, ten randomly selected receptor-antigen pairs were removed and marked as missing across all patients. TMTF decomposition was performed as described above, and then these left out data were compared to the reconstructed values. This process was repeated for the same chords across varying numbers of components.
